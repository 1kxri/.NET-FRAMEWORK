using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.IO;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using static System.Windows.Forms.VisualStyles.VisualStyleElement.Button;
using static System.Windows.Forms.VisualStyles.VisualStyleElement;

namespace LAB_8.NET_WF
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            
        }

        private void button2_Click(object sender, EventArgs e)
        {
            
        }

      
        private void button3_Click(object sender, EventArgs e)
        {
           
        }

       
        private void button4_Click(object sender, EventArgs e)
        {
            
        }

        
        private void button9_Click(object sender, EventArgs e)
        {

        }

        // Очистка полей
        private void button5_Click(object sender, EventArgs e)
        {

        }

        private void button6_Click(object sender, EventArgs e)
        {

        }

        private void button7_Click(object sender, EventArgs e)
        {

        }

        private void button8_Click(object sender, EventArgs e)
        {

        }

        private void tabPage2_Click(object sender, EventArgs e)
        {

        }







        private void button1_Click_1(object sender, EventArgs e)
        {
            textBox2.Clear();

            try
            {
                int[] numbers;

                if (radioButton1.Checked)
                {
                    string input = textBox1.Text.Trim();

                    if (string.IsNullOrWhiteSpace(input))
                    {
                        textBox2.Text = "Ошибка: не введено ни одного числа.";
                        return;
                    }

                    var list = new List<int>();
                    string[] parts = input.Split(new char[] { ' ', '\t', ',', ';' }, StringSplitOptions.RemoveEmptyEntries);

                    foreach (string part in parts)
                    {
                        if (int.TryParse(part, out int num))
                            list.Add(num);
                        else
                            textBox2.AppendText($"Пропущено некорректное значение: {part}\r\n");
                    }

                    if (list.Count == 0)
                    {
                        textBox2.AppendText("Ошибка: нет корректных целых чисел для записи.");
                        return;
                    }

                    numbers = list.ToArray();
                    textBox2.AppendText($"Введено чисел: {numbers.Length}\r\n");
                }
                else if (radioButton2.Checked)
                {


                    if (!int.TryParse(textBox1.Text, out int count) || count <= 0)
                    {
                        textBox2.Text = "Ошибка: количество чисел должно быть целым числом > 0.";
                        return;
                    }

                    numbers = new int[count];
                    Random rnd = new Random();
                    for (int i = 0; i < count; i++)
                        numbers[i] = rnd.Next(-99, 100);

                    textBox2.AppendText($"Сгенерировано случайных чисел: {count}\r\n");
                }
                else
                {
                    textBox2.Text = "Ошибка: выберите режим ввода чисел.";
                    return;
                }

                string projectRoot = Directory.GetParent(Directory.GetCurrentDirectory()).Parent.Parent.FullName;
                string innerFolder = Path.Combine(projectRoot, "NETFramework_cs_8_WF");
                if (!Directory.Exists(innerFolder))
                    Directory.CreateDirectory(innerFolder);

                string path = Path.Combine(innerFolder, "numbers.txt");

                File.WriteAllText(path, string.Join(" ", numbers));
                textBox2.AppendText($"Файл создан: {path}\r\n");
                textBox2.AppendText("Сохранённые числа:\r\n");
                textBox2.AppendText(string.Join(" ", numbers) + "\r\n");

                int evenCount = numbers.Count(n => n % 2 == 0);
                textBox2.AppendText($"Количество чётных чисел: {evenCount}");
            }
            catch (Exception ex)
            {
                textBox2.Text = $"Ошибка: {ex.Message}";
            }
        }

        private void button2_Click_1(object sender, EventArgs e)
        {
            textBox1.Clear();
            textBox2.Clear();
        }

        private void radioButton4_CheckedChanged(object sender, EventArgs e)
        {

        }

        private void button4_Click_1(object sender, EventArgs e)
        {
            textBox3.Clear();

            try
            {
                string folderPath = "", projectRoot = "";

                string assemblyLocation = System.Reflection.Assembly.GetExecutingAssembly().Location;
                string binDir = Path.GetDirectoryName(assemblyLocation);
                string debugDir = Path.GetDirectoryName(binDir);
                projectRoot = Path.GetDirectoryName(debugDir);

                if (radioButton3.Checked)
                {
                    string folderName = textBox4.Text.Trim();
                    if (string.IsNullOrWhiteSpace(folderName))
                    {
                        textBox3.Text = "Ошибка: введите имя папки.";
                        return;
                    }
                    string innerFolder = projectRoot;
                    folderPath = Path.Combine(innerFolder, folderName);
                }
                else if (radioButton4.Checked)
                {
                    string inputPath = textBox4.Text.Trim();
                    if (string.IsNullOrWhiteSpace(inputPath))
                    {
                        textBox3.Text = "Ошибка: введите полный путь к папке.";
                        return;
                    }
                    if (!Path.IsPathRooted(inputPath))
                    {
                        inputPath = Path.Combine(projectRoot, inputPath);
                    }
                    folderPath = inputPath;
                }
                else
                {
                    textBox3.Text = "Ошибка: выберите режим создания папки.";
                    return;
                }

                textBox3.AppendText($"Полный путь к папке: {folderPath}\r\n");

                if (Directory.Exists(folderPath))
                {
                    textBox3.AppendText($"Папка уже существует");
                }
                else
                {
                    Directory.CreateDirectory(folderPath);
                    textBox3.AppendText($"Папка успешно создана");
                }
            }
            catch (Exception ex)
            {
                textBox3.Text = $"Ошибка при создании папки: {ex.Message}";
            }
        }

        private void button3_Click_1(object sender, EventArgs e)
        {
            textBox3.Clear();
            textBox4.Clear();
        }

        private void button5_Click_1(object sender, EventArgs e)
        {
            textBox5.Clear();

            string fileName = textBox6.Text.Trim();
            if (string.IsNullOrWhiteSpace(fileName))
            {
                textBox5.Text = "Ошибка: введите имя файла (например, test.txt)";
                return;
            }

            try
            {
                string projectRoot = Directory.GetParent(Application.StartupPath).Parent.Parent.FullName;
                string innerFolder = Path.Combine(projectRoot, "NETFramework_cs_8_WF");
                if (!Directory.Exists(innerFolder))
                    Directory.CreateDirectory(innerFolder);

                string filePath = Path.Combine(innerFolder, fileName);

                string method = comboBox1.SelectedItem?.ToString();
                if (string.IsNullOrWhiteSpace(method))
                {
                    textBox5.Text = "Ошибка: выберите метод создания файла из списка";
                    return;
                }

                switch (method)
                {
                    case "File.Create()":
                        using (File.Create(filePath)) { }
                        textBox5.Text = $"Файл создан методом File.Create()\r\nПолный путь: {filePath}";
                        break;

                    case "File.WriteAllText()":
                        File.WriteAllText(filePath, $"Текст записан методом File.WriteAllText()\r\nДата создания: {DateTime.Now}");
                        textBox5.Text = $"Файл создан методом WriteAllText и заполнен\r\nПолный путь: {filePath}";
                        break;

                    case "File.AppendAllText()":
                        File.AppendAllText(filePath, $"Текст дописан методом AppendAllText\r\nДата: {DateTime.Now}\r\n");
                        textBox5.Text = $"Файл создан/дополнен методом AppendAllText\r\nПолный путь: {filePath}";
                        break;

                    case "FileStream":
                        using (FileStream fs = new FileStream(filePath, FileMode.Create, FileAccess.Write))
                        {
                            byte[] data = Encoding.UTF8.GetBytes($"Текст записан через FileStream\r\nДата: {DateTime.Now}");
                            fs.Write(data, 0, data.Length);
                        }
                        textBox5.Text = $"Файл создан методом FileStream\r\nПолный путь: {filePath}";
                        break;

                    case "StreamWriter":
                        using (StreamWriter writer = new StreamWriter(filePath))
                        {
                            writer.WriteLine("Текст записан через StreamWriter");
                            writer.WriteLine($"Дата создания: {DateTime.Now}");
                        }
                        textBox5.Text = $"Файл создан методом StreamWriter\r\nПолный путь: {filePath}";
                        break;

                    default:
                        textBox5.Text = "Ошибка: неизвестный метод создания файла";
                        break;
                }
            }
            catch (Exception ex)
            {
                textBox5.Text = $"Ошибка при создании файла: {ex.Message}";
            }
        }

        private void button6_Click_1(object sender, EventArgs e)
        {
            textBox5.Clear();
            textBox6.Clear();
        }

        private void tabPage4_Click(object sender, EventArgs e)
        {

        }

        private void button8_Click_1(object sender, EventArgs e)
        {
            textBox8.Clear();

            string fileName = textBox7.Text.Trim();
            if (string.IsNullOrWhiteSpace(fileName))
            {
                textBox8.Text = "Ошибка: введите имя файла для чтения (например, test.txt)";
                return;
            }

            try
            {
                string projectRoot = Directory.GetParent(Application.StartupPath).Parent.Parent.FullName;
                string innerFolder = Path.Combine(projectRoot, "NETFramework_cs_8_WF");
                if (!Directory.Exists(innerFolder))
                {
                    textBox8.Text = $"Ошибка: папка проекта не найдена: {innerFolder}";
                    return;
                }

                string filePath = Path.Combine(innerFolder, fileName);

                if (!File.Exists(filePath))
                {
                    textBox8.Text = $"Ошибка: файл не найден: {filePath}";
                    return;
                }

                string method = comboBox2.SelectedItem?.ToString();
                if (string.IsNullOrWhiteSpace(method))
                {
                    textBox8.Text = "Ошибка: выберите метод чтения файла из списка";
                    return;
                }

                textBox8.AppendText($"Содержимое файла ({filePath}):\r\n\r\n");

                switch (method)
                {
                    case "File.ReadAllText()":
                        string text = File.ReadAllText(filePath);
                        textBox8.AppendText(text);
                        break;

                    case "File.ReadAllLines()":
                        string[] lines = File.ReadAllLines(filePath);
                        foreach (string line in lines)
                            textBox8.AppendText(line + Environment.NewLine);
                        break;

                    case "FileStream + StreamReader":
                        using (FileStream fs = new FileStream(filePath, FileMode.Open, FileAccess.Read))
                        using (StreamReader reader = new StreamReader(fs, Encoding.UTF8))
                        {
                            textBox8.AppendText(reader.ReadToEnd());
                        }
                        break;

                    case "StreamReader напрямую":
                        using (StreamReader reader = new StreamReader(filePath, Encoding.UTF8))
                        {
                            string line;
                            while ((line = reader.ReadLine()) != null)
                                textBox8.AppendText(line + Environment.NewLine);
                        }
                        break;

                    default:
                        textBox8.AppendText("Ошибка: неизвестный метод чтения файла");
                        break;
                }
            }
            catch (Exception ex)
            {
                textBox8.Text = $"Ошибка при чтении файла: {ex.Message}";
            }
        }

        private void button7_Click_1(object sender, EventArgs e)
        {
            textBox7.Clear();
            textBox8.Clear();
        }
    }
}
